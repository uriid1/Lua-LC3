# VM LC-3 0.1
LC-3 это 16-битная виртуальная машина

Архитектура:
  * Тип процессора: кастомный
  * Разярдность: 16 бит
  * Регистры общего назаначения: R0, R1, R2, R3, R4, R5, R6, R7
  * Регистры специального назначения
    * PC (Program Counter) — счетчик команд
    * COND (Condition) - состояние посленего условия
  * Память: 2^16 = 65536 (0x0000 – 0xFFFF) слов, каждое слово = 16 бит
  * Порядок байт: Big-endian (старший байт идет первым)
  * Размер инструкций: 16 бит (фиксированная длина)

Кодирование инструкций:
```
--------------------------------------------------
| 15-12  | 11-9  |  8-6   | 5 | 4  3  2 | 1  0   |
| -------+-------+--------+---+----------------- |
| OPCODE |  DR   |  SR1   | M |  OPERAND         |
--------------------------------------------------
```

Регистры:
  R0, R1, R2, R3, R4, R5, R6, R7, PC, CND, CNT

# Инстуркции

*ADD*
Синтаксис: ADD DR, SR1, SR2  или  ADD DR, SR1, imm5
Описание: Сложение SR1 + SR2 или SR1 + imm5 и сохранение в DR
Формат:
```
------------------------------------------------------
| Bits   | 15-12  | 11-9   | 8-6   | 5-3    | 2-0    |
|--------+--------+--------+-------+--------+---------
| Usage  | OPCODE | DR     | SR1   | 0 0 0  | SR2    |
------------------------------------------------------
```

*AND*
Синтаксис: AND DR, SR1, SR2  или  AND DR, SR1, imm5
Описание: Побитовое логическое `И`, аналогично команде `ADD`
Формат:
```
------------------------------------------------------
| Bits   | 15-12  | 11-9   | 8-6   | 5-3    | 2-0    |
|--------+--------+--------+-------+--------+---------
| Usage  | OPCODE | DR     | SR1   | 0 0 0  | SR2    |
------------------------------------------------------
```

*NOT*
Синтаксис: NOT DR, SR1
Описание: Побитовое "НЕ" для DR ~ SR1, результат сохраняется в DR 
Формат:
```
------------------------------------------------
| Bits   | 15-12  | 11-9   | 8-6   | 5-0       |
|--------+--------+--------+-------+------------
| Usage  | OPCODE | DR     | SR1   | 1 1 1 1 1 |
------------------------------------------------
```

*LDI (Load Indirect)*
Синтаксис: lDI DR1, OFFSET9
Описание: Загружает данные по косвенному адресу в регистр назначения
Формат:
```
-------------------------------------------
| Bits   | 15-12  | 11-9   | 8-0          |
|--------+--------+--------+--------------|
| Usage  | OPCODE | DR1    | OFFSET9      |
-------------------------------------------
```

*BR*
Синтаксис: BR*, например, BRz, BR, BRnp и.т.д

Описание: Условное ответвление
z - Равно нулю
p - Больше нуля
n - Меньше нуля

Формат:
```
--------------------------------------------------
| Bits   | 15-12     | 9-11        | 8-0         |
|--------+-----------+-------------+--------------
| Usage  | OPCODE    | Cond flag   | OFFSET9     |
--------------------------------------------------
```

*LD*
Синтаксис: LD DR, LABEL
Описание: Загрузка значения метки в DR
Формат:
```
-------------------------------------------
| Bits   | 15-12  | 11-9   | 8-0          |
|--------+--------+--------+--------------|
| Usage  | OPCODE | DR     | OFFSET9      |
-------------------------------------------
```

*ST (Store Direct)*
Синтаксис: ST SR, LABEL(pc+OFFSET9)
Описание: Сохранение значения из регистра в область памяти
Формат:
```
-------------------------------------------
| Bits   | 15-12  | 11-9   | 8-0          |
|--------+--------+--------+--------------|
| Usage  | OPCODE | SR     | OFFSET9      |
-------------------------------------------
```

*STR (Store Register)*
Синтаксис: STR SR, LABEL(pc+OFFSET9)
Описание: Запись содержимого регистра в память по адресу, который вычисляется на основе другого регистра и смещения
Формат:
```
-------------------------------------------------
| Bits   | 15-12  | 11-9  | 8-6     |  5-0      |
|--------+--------+------+----------+-----------|
| Usage  | OPCODE | SR   |  BASER   |  OFFSET6  |
-------------------------------------------------
```

*STI (Store Indirect)*
Синтаксис: STR SR, LABEL(pc+OFFSET9)
Описание: Записывает содержимое регистра в память по адресу, который сам находится в памяти
Формат:
```
-------------------------------------------
| Bits   | 15-12  | 11-9   | 8-0          |
|--------+--------+--------+--------------|
| Usage  | OPCODE | SR     | OFFSET9      |
-------------------------------------------
```

*LDR*
Синтаксис: LDR DR, BASER, OFFSET6
Описание: 
Формат:
```
-------------------------------------------------
| Bits   | 15-12  | 11-9  | 8-6     |  5-0      |
|--------+--------+------+----------+-----------|
| Usage  | OPCODE | DR   |  BASER   |  OFFSET6  |
-------------------------------------------------
```

*LEA*
Описание: Загрузка фактического адреса
Синтаксис: LEA DR, LABEL
Формат:
```
--------------------------------------
| Bits   | 15-12  | 11-9   | 8-0     |
|--------+--------+--------+----------
| Usage  | OPCODE | DR1    | OFFSET9 |
--------------------------------------
```
